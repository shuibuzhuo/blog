å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å“ˆé»˜ã€‚`indexOf` æ˜¯æˆ‘ä»¬éå¸¸ç†Ÿæ‚‰çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå¯ä»¥ç”¨æ¥è·å–æŸä¸€ä¸ªå…ƒç´ åœ¨ä¸€ä¸ªæ•°ç»„é‡Œçš„ä½ç½®ï¼Œæˆ‘ä»¬ä¸€èˆ¬å°±ä¼šä½¿ç”¨ `array.indexOf(element)` çš„æ–¹æ³•æ¥è¿›è¡Œä½¿ç”¨ã€‚

ä½†æ˜¯ï¼Œå¤§å®¶æœ‰æ²¡æœ‰ä½¿ç”¨è¿‡ indexOf çš„`ç¬¬äºŒä¸ªå‚æ•°`å‘¢ï¼Ÿç¬¬äºŒä¸ªå‚æ•°çš„ä½¿ç”¨ä¼šç»å¸¸å‡ºç°åœ¨ä¸€äº›ä¼˜ç§€çš„åº“çš„æºç å½“ä¸­ï¼Œç”¨äºä¾æ¬¡åˆ†æï¼ˆæˆ–è€…è¯´æ‰«æï¼‰æŸä¸€ä¸ªå­—ç¬¦ä¸²ã€‚

æ¯”å¦‚å‘½ä»¤è¡Œç¾åŒ–è¾“å‡ºçš„ `chalk` åº“ä¸­å°±æœ‰æ­¤åº”ç”¨ï¼Œå› ä¸º chalk åº“çš„åŸç†å°±æ˜¯å¯¹äºæˆ‘ä»¬è¾“å‡ºåœ¨ç»ˆç«¯çš„å†…å®¹è¿›è¡Œå¤„ç†ï¼Œç„¶åå°†å¤„ç†åçš„å­—ç¬¦ä¸²æ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸Šã€‚

## indexOf åŸºæœ¬ç”¨æ³•

é¦–å…ˆï¼Œæˆ‘ä»¬è¿˜æ˜¯å…ˆæ¥å›é¡¾ä¸€ä¸‹ `indexOf` çš„æœ€åŸºæœ¬ç”¨æ³•ã€‚

ç»™å®šä¸€ä¸ªæ•°ç»„ï¼š`[10, 20, 30]`ï¼Œå¯»æ‰¾è¿™ä¸ªæ•°ç»„ä¸­ `30` çš„ä½ç½®ï¼Œæ˜¯ `2`ã€‚

```js
const arr = [10, 20, 30];
const element = 30;
const index = arr.indexOf(element);

console.log(index); // 2
```

## indexOf çš„ç¬¬äºŒä¸ªå‚æ•°

æ˜ç¡®äº† indexOf çš„åŸºæœ¬ç”¨æ³•ä»¥åï¼Œå®ƒçš„ç¬¬ 2 ä¸ªå‚æ•°æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ

å…¶å®æ˜¯èµ·åˆ°äº†ä¸€ä¸ªè°ƒæ•´ä»å“ªé‡Œå¼€å§‹æŸ¥æ‰¾çš„ä½œç”¨ã€‚

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š

```js
const arr = [10, 20, 30];
const element = 10;
const index = arr.indexOf(element);

console.log(index); // 0

const arr2 = [10, 20, 30, 10];
const element2 = 10;
const index2 = arr2.indexOf(element2, 1);

console.log(index2); // 3
```

å¯ä»¥çœ‹åˆ°ï¼ŒåŒæ ·æ˜¯æŸ¥æ‰¾ `[10, 20, 30, 10]` å½“ä¸­ 10 çš„ä½ç½®ï¼Œä½†æ˜¯å› ä¸ºç¬¬ä¸€æ¬¡æ˜¯ä»æ•°ç»„ç¬¬ 1 ä¸ªå…ƒç´ å¼€å§‹æŸ¥æ‰¾çš„ï¼Œæ‰€ä»¥å¾—åˆ°çš„ç»“æœæ˜¯ 0ã€‚

è€Œç¬¬äºŒæ¬¡æ˜¯ä»æ•°ç»„çš„ç¬¬ 2 ä¸ªå…ƒç´ å¼€å§‹æŸ¥æ‰¾çš„ï¼Œæ‰€ä»¥å¾—åˆ°çš„ç»“æœæ˜¯ 3ã€‚

## ä¼˜ç§€åº“æºç é‡Œçš„ä½¿ç”¨

æ˜ç¡®äº† indexOf ç¬¬äºŒä¸ªå‚æ•°çš„ä½¿ç”¨ä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹åœ¨ä¸€äº›ä¼˜ç§€çš„åº“çš„æºç é‡Œé¢ï¼Œå®ƒä»¬æ˜¯å¦‚ä½•åˆ©ç”¨èµ·è¿™ä¸ªç¬¬äºŒä¸ªå‚æ•°çš„ä½œç”¨çš„ã€‚

> âš ï¸ æ³¨æ„ï¼šæˆ‘ä¸‹é¢ä¼šä»¥ `String.prototype.indexOf` ä¸¾ä¾‹ï¼Œè€Œä¸Šé¢ä¸¾çš„ä¾‹å­æ˜¯ä»¥ `Array.prototype.indexOf` ä¸ºä¾‹ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ª API çš„ç¬¬äºŒä¸ªå‚æ•°éƒ½æ˜¯èµ·åˆ°ä¸€ä¸ªæœç´¢ä½ç½®çš„ä½œç”¨ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œå¯ä»¥ä¸€èµ·å­¦ä¹ ä¸€ä¸‹

è¿™é‡Œï¼Œæˆ‘ä»¬åªä¼šåˆ†æå®ƒçš„æ€æƒ³ï¼Œå…·ä½“çš„å®ç°åœ¨å…·ä½“çš„æºç é‡Œä¼šå­˜åœ¨å·®å¼‚ï¼Œä½†æ€æƒ³æ˜¯ç›¸åŒçš„ã€‚

æˆ‘ä»¬é¦–å…ˆå®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œ`addEmoji`ï¼Œæ¥å—ä¸‰ä¸ªå‚æ•°ï¼š

```js
/**
 * åœ¨ä¸€ä¸ª string çš„ targetString åé¢ï¼ŒåŠ ä¸Šä¸€ä¸ª emoji
 * @param string åŸå§‹ string
 * @param targetString åŠ  emoji çš„é‚£ä¸ª string
 * @param emoji åŠ å…¥çš„ emoji
 * @returns å¤„ç†åçš„æœ€ç»ˆç»“æœ
 */
function addEmoji(string, targetString, emoji) {
  let result = "";

  // ä¸€ç³»åˆ—å¤„ç†
  // ...

  return result;
}
```

æˆ‘ä»¬æœ€ç»ˆä¼šè¿™æ ·è°ƒç”¨ï¼Œåœ¨ `å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å“ˆé»˜ï¼Œä»Šå¤©æ˜¯ä¸€ä¸ªå¥½å¤©æ°”ã€‚` çš„ `å¥½` è¿™ä¸ªå­—çš„åé¢ï¼ŒåŠ ä¸Š ğŸ‘ çš„ emojiï¼š

```js
const res = addEmoji("å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å“ˆé»˜ï¼Œä»Šå¤©æ˜¯ä¸€ä¸ªå¥½å¤©æ°”ã€‚", "å¥½", "ğŸ‘");
console.log(res);
```

é‚£ä¹ˆé¦–å…ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ indexOf æ–¹æ³•æ¥ä»è¾“å…¥çš„å­—ç¬¦ä¸²é‡Œæ‰¾åˆ° `å¥½` çš„ä½ç½®ï¼š

```js
function addEmoji(string, targetString, emoji) {
  // æ‰¾åˆ° targetString çš„ä½ç½®
  let index = string.indexOf(targetString);

  let result = "";

  // è®°å½•å½“å‰æ‰«æåˆ°çš„ä½ç½®ï¼Œç°åœ¨æ˜¯åœ¨å‚æ•° string çš„å¼€å¤´ä½ç½®
  // å› ä¸º string å½“ä¸­ï¼Œå¯èƒ½ä¼šå­˜åœ¨å¤šä¸ª targetStringï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šè·³ç€è¿›è¡Œæ‰«æï¼Œä¹Ÿå°±æ˜¯ä¼šä½¿ç”¨ indexOf çš„ç¬¬äºŒä¸ªå‚æ•°
  let currentScanIndex = 0;

  return result;
}
```

å¦‚æœæˆ‘ä»¬æ‰¾åˆ°äº† targetStringï¼Œå³ `index !== -1`ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åœ¨ targetString åï¼ŒåŠ ä¸Šä¸€ä¸ª emojiï¼š

```js
function addEmoji(string, targetString, emoji) {
  // æ‰¾åˆ° targetString çš„ä½ç½®
  let index = string.indexOf(targetString);

  let result = "";

  // è®°å½•å½“å‰æ‰«æåˆ°çš„ä½ç½®ï¼Œç°åœ¨æ˜¯åœ¨å‚æ•° string çš„å¼€å¤´ä½ç½®
  // å› ä¸º string å½“ä¸­ï¼Œå¯èƒ½ä¼šå­˜åœ¨å¤šä¸ª targetStringï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šè·³ç€è¿›è¡Œæ‰«æï¼Œä¹Ÿå°±æ˜¯ä¼šä½¿ç”¨ indexOf çš„ç¬¬äºŒä¸ªå‚æ•°
  let currentScanIndex = 0;

  // å¦‚æœæ‰¾åˆ°äº† targetString
  if (index !== -1) {
    // åœ¨ targetString åé¢å¢åŠ  emoji
    result += string.slice(currentScanIndex, index) + targetString + emoji;
    // å°†å½“å‰æ‰«æä½ç½®ï¼Œç§»åŠ¨åˆ° targetString ä¹‹åçš„é‚£ä¸ªä½ç½®ä¸Š
    currentScanIndex = index + targetString.length;
  }

  // å°† targetString ä¹‹åçš„å†…å®¹è¿½åŠ åˆ° result é‡Œ
  result += string.slice(currentScanIndex);

  return result;
}
```

æ­¤æ—¶ï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ª `å¥½` å­—åé¢ï¼ŒåŠ ä¸Šäº† `ğŸ‘`ï¼Œå¾—åˆ°çš„ç»“æœï¼š

![](./res1.png)

ä½†æ˜¯ï¼Œæˆ‘ä»¬è¿™ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ª `å¥½å¤©æ°”` çš„ `å¥½`ï¼Œä¹Ÿå°±æ˜¯å­˜åœ¨å¤šä¸ª `targetString`ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä¸èƒ½æ˜¯ `if` åªæ‰§è¡Œä¸€æ¬¡ï¼Œè€Œæ˜¯è¦åšä¸€ä¸ªå¾ªç¯ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª while å¾ªç¯ï¼š

```diff
function addEmoji(string, targetString, emoji) {
  // æ‰¾åˆ° targetString çš„ä½ç½®
  let index = string.indexOf(targetString);

  let result = "";

  // è®°å½•å½“å‰æ‰«æåˆ°çš„ä½ç½®ï¼Œç°åœ¨æ˜¯åœ¨å‚æ•° string çš„å¼€å¤´ä½ç½®
  // å› ä¸º string å½“ä¸­ï¼Œå¯èƒ½ä¼šå­˜åœ¨å¤šä¸ª targetStringï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šè·³ç€è¿›è¡Œæ‰«æï¼Œä¹Ÿå°±æ˜¯ä¼šä½¿ç”¨ indexOf çš„ç¬¬äºŒä¸ªå‚æ•°
  let currentScanIndex = 0;

  // å¦‚æœæ‰¾åˆ°äº† targetString
  while (index !== -1) {
    // åœ¨ targetString åé¢å¢åŠ  emoji
    result += string.slice(currentScanIndex, index) + targetString + emoji;
    // å°†å½“å‰æ‰«æä½ç½®ï¼Œç§»åŠ¨åˆ° targetString ä¹‹åçš„é‚£ä¸ªä½ç½®ä¸Š
    currentScanIndex = index + targetString.length;
+   // é‡ç‚¹æ¥äº†ï¼ï¼ï¼æˆ‘ä»¬è¦ä»å½“å‰æ‰«æçš„ä½ç½®å¼€å§‹ï¼Œå»å¯»æ‰¾ targetString
+   index = string.indexOf(targetString, currentScanIndex);
  }

  // å°† targetString ä¹‹åçš„å†…å®¹è¿½åŠ åˆ° result é‡Œ
  result += string.slice(currentScanIndex);

  return result;
}
```

æ­¤æ—¶ï¼Œæˆ‘ä»¬ä¾¿æˆåŠŸçš„ç»™ç¬¬äºŒä¸ª `å¥½`ï¼Œä¹ŸåŠ ä¸Šäº† emojiï¼š

![res2](./res2.png)

è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬å°±ä½¿ç”¨åˆ°äº†ä¹‹å‰æåˆ°çš„ indexOf çš„ç¬¬äºŒä¸ªå‚æ•°ï¼š

```js
// é‡ç‚¹æ¥äº†ï¼ï¼ï¼æˆ‘ä»¬è¦ä»å½“å‰æ‰«æçš„ä½ç½®å¼€å§‹ï¼Œå»å¯»æ‰¾ targetString
index = string.indexOf(targetString, currentScanIndex);
```

æˆ‘ä»¬æ˜¯ä»å½“å‰æ‰«æåˆ°çš„ä½ç½® `currentScanIndex` å¼€å§‹ï¼ŒæŸ¥æ‰¾ `targetString` çš„ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ‰¾åˆ°ä¸‹ä¸€ä¸ª `targetString` äº†ã€‚

æ‰€ä»¥ï¼Œè¿™é‡Œçš„æ€æƒ³å°±æ˜¯é€šè¿‡ indexOf çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¸®åŠ©æˆ‘ä»¬èƒ½å¤Ÿä¾æ¬¡æ‰«æä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¾æ¬¡æ‰¾åˆ°æˆ‘ä»¬æƒ³è¦æ‰¾çš„é‚£ä¸ªå…ƒç´ çš„ä½ç½®ï¼Œç„¶ååšç›¸åº”çš„å¤„ç†ã€‚

## æ€»ç»“

indexOf çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå« `fromIndex`ï¼Œçœ‹åˆ°è¿™é‡Œï¼Œå¤§å®¶åº”è¯¥ä¹Ÿèƒ½å¾ˆå¥½çš„ç†è§£è¿™ä¸ª `fromIndex` çš„ä½œç”¨äº†ï¼Œå°±æ˜¯ä»å“ªé‡Œå¼€å§‹æ‰¾å˜›ï¼
